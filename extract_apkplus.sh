#!/bin/bash

# Specify the directory containing the .apk+ files
apk_dir="/path/to/apk/files"

# Navigate to the directory
cd "$apk_dir" || { echo "Directory not found"; exit 1; }

# Loop through each .apk+ file
for apkplus_file in *.apk+; do
    # Strip the "+"
    apk_name="${apkplus_file%.apk+}"

    # Rename .apk+ to .zip
    mv "$apkplus_file" "$apk_name.zip"

    # Extract base.apk from the zip
    unzip "$apk_name.zip" base.apk -d "$apk_name"

    # Rename base.apk to {apkname}.apk
    mv "$apk_name/base.apk" "$apk_name/$apk_name.apk"

    # Move the apk file from the temp dir before nuking it.

    mv "$apk_name/$apk_name.apk" "$apk_dir"

    # Clean up: remove the temporary extracted directory
    rm -r "$apk_name"
done
